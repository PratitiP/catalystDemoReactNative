name: Cache List
on:
  workflow_dispatch:

env:
  OWNER: ${{ github.repository_owner }}
  REPO: ${{ github.event.repository.name }}
  GH_TOKEN: ${{ github.token }}

jobs:
  cache:
    permissions: write-all
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Code
        uses: actions/checkout@v3

      - name: Cache Get
        id: cache-list
        run: |
          cacheList="$(gh api \
          -H "Accept: application/vnd.github+json" \
           -H "X-GitHub-Api-Version: 2022-11-28" \
           /repos/$OWNER/$REPO/actions/caches)"

          echo "cache_list=$cacheList" >> "$GITHUB_OUTPUT"

      - name: echo command
        run: echo 'Owner' = $OWNER 'Repo' $REPO 'GH_TOKEN'= $GH_TOKEN

      - name: Print Actions Cache
        run: echo "${{steps.cache-list.outputs.cache_list}}"

      - name: Print the array ids
        run: |
          cacheList = ${{steps.cache-list.outputs.cache_list}}
          all_ids="$(jq '.actions_caches[].id' cacheList | tr '\n' ' ')"
          echo $all_ids
